"use strict";define("modules/constants",["require","exports"],function(y,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_IMAGE=t.TAB=t.FUSE_TYPE_INFO=t.FUSE_STYLE_INFO=t.PATH1=t.PATH2=t.IMG_LRG=t.MCASE_ADAPTER=t.MAX_TABS=t.MOBILE_MAX_ITEMS=t.MAX_RESULTS=t.MAX_ACCESSORIES=t.MAX_RELATED_PRODUCTS=t.DIVIDER=t.SEGMENTS=t.PARTS=t.RESULTS=t.ACCESSORIES=t.RELATED_PRODUCTS=t.NAV=t.BACK=t.PATH=t.PRODUCT_GUIDE=t.BUY_NOW=t.PRINT=t.DATASHEET=t.DESCRIPTION=t.IMAGE=t.PART=t.SERIES=t.SPECS=t.DELIMETER=t.RESET=t.QUESTION=t.OPTION=t.fieldNodesDict=t.path1Fields=t.path2Fields=t.transitionFields=void 0,t.transitionFields={"fuse type":"fuse type-path2","fuse style":"fuse style-path2","max voltage":"max voltage-path2","max current":"max current-path2"},t.path2Fields=["fuse type","application voltage","application load","application amps","fuse style-path2"],t.path1Fields=["fuse type","fuse style","max voltage","max current","circuit option","style","mounting method","protection","part"],t.fieldNodesDict={"application voltage":{type:"question",pathText:"Voltage: {{}}"},"application load":{type:"question",pathText:"Load: {{}}",questionStrategy:"masking",multiValue:!0},"application amps":{type:"question",pathText:"Amps: {{}}",questionStrategy:"slider"},"fuse style-path2":{type:"question",pathText:"Style: {{}}",questionStrategy:"segments"},"max voltage-path2":{type:"question",pathText:"Volts: <={{}}V DC",breakKeys:!0},"max current-path2":{type:"question",pathText:"Amps: {{}}A",breakKeys:!0},"fuse type":{type:"question",pathText:"Fuse Type: {{}}"},"fuse type-path2":{type:"question",pathText:"{{}}"},"fuse style":{type:"question",pathText:"Fuse Style: {{}}",questionStrategy:"masking-with-subcategories"},"max voltage":{type:"question",pathText:"Volts: {{}}V DC",questionStrategy:"hiding"},"max current":{type:"question",pathText:"Amps: {{}}A",questionStrategy:"hiding"},"circuit option":{type:"question",pathText:"Circuit: {{}}",questionStrategy:"masking"},style:{type:"question",pathText:"Style: {{}}",questionStrategy:"masking",skipif:["PCBA","Fuse Block"]},"mounting method":{type:"question",pathText:"Mounting: {{}}",questionStrategy:"masking-with-subcategories",skipBackIf:{style:["PCBA","Fuse Block"]}},protection:{type:"question",pathText:"Protection: {{}}",questionStrategy:"masking"},part:{type:"result",pathText:""}},t.OPTION="answer",t.QUESTION="q",t.RESET="reset",t.DELIMETER=":",t.SPECS="specs",t.SERIES="series",t.PART="part",t.IMAGE="img",t.DESCRIPTION="description",t.DATASHEET="datasheet",t.PRINT="2d print",t.BUY_NOW="buy-now",t.PRODUCT_GUIDE="product guide",t.PATH="path",t.BACK="back",t.NAV="nav",t.RELATED_PRODUCTS="related products",t.ACCESSORIES="accessories",t.RESULTS="module",t.PARTS="part module",t.SEGMENTS="segment",t.DIVIDER=";",t.MAX_RELATED_PRODUCTS=2,t.MAX_ACCESSORIES=4,t.MAX_RESULTS=5,t.MOBILE_MAX_ITEMS=1,t.MAX_TABS=4,t.MCASE_ADAPTER="mcase-adapter",t.IMG_LRG="img lrg",t.PATH2="path2",t.PATH1="path1",t.FUSE_STYLE_INFO="fuse style info",t.FUSE_TYPE_INFO="fuse type info",t.TAB="tab",t.DEFAULT_IMAGE="https://info.littelfuse.com/hubfs/Transportation_Logistics/Files%20and%20Presentations/Ceros/Image-Not-Available.jpg"}),define("modules/lib/Node",["require","exports"],function(y,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;class a{constructor(g,u="",i=null){this.name=g,this.value=u,this.parent=i,this.children=[],this.elementId="",this.data={}}findChildByValueProperty(g){return this.children.find(u=>u.value.toLowerCase()===g.toLowerCase())||null}findChildThatIncludesValue(g){return this.children.find(u=>u.value.toLowerCase()===g.toLowerCase())||null}findAllChildrenThatIncludeValue(g){return this.children.filter(u=>u.value.toLowerCase()===g.toLowerCase())||null}findParentByName(g){let u=this;for(;u;){if(u.name===g)return u;u=u.parent}}getPath(){const g=[];let u=this;for(;u;)g.unshift({name:u.name,value:u.value}),u=u.parent;return g}}t.Node=a}),define("modules/lib/treeHelpers",["require","exports","../constants"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MERGE_FIELDS_P1=void 0,t.makeKey=g,t.makeKeys=i,t.getChildrenByPath=e,t.getP1MergeValsFromP2Node=r,t.MERGE_FIELDS_P1=["fuse type","fuse style","max voltage","max current"];function p(d){return(d??"").trim().toLowerCase().replace(/\s+/g," ")}function g(d,s){return s.map(l=>p(d[l])||"\u2205").join("|")}function u(d,s,l=","){const o=Object.entries(d);let h=[{}];for(const[c,f]of o){const m=s[a.transitionFields[c]],S=f??"";h=(m?.breakKeys&&S.includes(l)?S.split(l).map(C=>C.trim()).filter(Boolean):[S]).flatMap(C=>h.map(T=>Object.assign(Object.assign({},T),{[c]:C})))}return h}function i(d,s,l){const o=[];return Object.keys(d).filter(f=>l[a.transitionFields[f]].breakKeys).length?u(d,l,",").forEach(m=>o.push(g(m,s))):o.push(g(d,s)),o}function e(d,s){const l=d.split("|");return n(0,s,l,[])}function n(d,s,l,o){return d===t.MERGE_FIELDS_P1.length?s.children:(s.findAllChildrenThatIncludeValue(l[d]).forEach(c=>{o=o.concat(n(d+1,c,l,o))}),o)}function r(d,s){const l={};for(const o of t.MERGE_FIELDS_P1){const h=s[o]||o,c=d.data[h];if(!c)return null;l[o]=c}return l}}),define("modules/lib/NodeTree",["require","exports","./Node","./treeHelpers","./treeHelpers"],function(y,t,a,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeTree=void 0;class u{constructor(e){this.fields=e,this.root=new a.Node("Root")}buildTree(e,n){e.forEach(r=>{this.addBranch(this.root,r,n)}),console.log(this.root)}addNewNode(e,n,r,d={}){const s=r.findChildByValueProperty(e);if(s)return s;{const l=new a.Node(n,e,r);return l.data=d,r.children.push(l),l}}addBranch(e,n,r){var d,s;let l=e;for(let o=0;o<r.length;o++){const h=r[o].trim(),c=(s=(d=n[h])===null||d===void 0?void 0:d.trim)===null||s===void 0?void 0:s.call(d);if(c){if(this.fields[h].multiValue){const f=r.slice(o+1);n[h].split(",").map(S=>S.trim()).forEach(S=>{let b;this.fields[h].type==="result"||this.fields[h].questionStrategy==="segments"||o===r.length-1?b=this.addNewNode(S,h,l,n):b=this.addNewNode(S,h,l),this.addBranch(b,n,f)});return}this.fields[h].type==="result"||this.fields[h].questionStrategy==="segments"||o===r.length-1?l=this.addNewNode(c,h,l,n):l=this.addNewNode(c,h,l)}}}mergeNodes(e,n,r){const d=(0,g.getP1MergeValsFromP2Node)(e,n);if(d){const s=(0,p.makeKeys)(d,p.MERGE_FIELDS_P1,this.fields);let l=[];s.forEach(o=>{const h=(0,p.getChildrenByPath)(o,r.root);l=[...l,...h]}),this.attachNewChildren(l,e)}}attachNewChildren(e,n){!e||e.length===0||e.forEach(r=>{const d=this.addNewNode(r.value,r.name,n,r.data),s=r.children;this.attachNewChildren(s,d)})}mergeDataWithFields(e,n,r){const d=s=>{if(s.children.length===0){this.mergeNodes(s,r,e);return}for(const l of s.children)d(l)};for(const s of n.children)d(s)}findChild(e,n,r){return e.children.find(d=>d[n].toLowerCase()===r.toLowerCase().trim())}}t.NodeTree=u}),define("modules/Observer",["require","exports"],function(y,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonStrictObservable=t.Observable=t.Observer=void 0;class a{constructor(){this.subscribers=new Set}subscribe(i){this.subscribers.add(i)}notify(i){this.subscribers.forEach(e=>e(i))}}t.Observer=a;class p extends a{constructor(i){super(),this._value=i}get value(){return this._value}set value(i){this._value!==i&&(this._value=i,this.notify(this._value))}}t.Observable=p;class g extends a{constructor(i){super(),this._value=i}get value(){return this._value}set value(i){this._value=i,this.notify(this._value)}}t.NonStrictObservable=g}),define("modules/utils",["require","exports","./constants"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMobile=t.setImageUrl=t.getModuleTag=t.stepsFromFieldNames=t.capitalize=t.getValueFromTags=void 0;const p=(r,d,s=a.DELIMETER)=>{const l=r.find(o=>o.trim().startsWith(`${d}${s}`));return l?l.split(a.DELIMETER)[1].trim():""};t.getValueFromTags=p;const g=r=>r?r.split(" ").map(s=>s[0].toUpperCase()+s.slice(1)).join(" "):"";t.capitalize=g;const u=(r,d)=>{const s=r.map(l=>[l,d[l]]);return Object.fromEntries(s)};t.stepsFromFieldNames=u;const i=(r,d,s)=>r>1?`${r}-${s}-${d+1}`:`${r}-${s}`;t.getModuleTag=i;const e=(r,d)=>{try{new URL(r),d.setUrl(r)}catch(s){console.error(s),d.setUrl(a.DEFAULT_IMAGE)}};t.setImageUrl=e;const n=r=>r.findComponentsByTag("mobile").components.length>0;t.isMobile=n}),define("modules/DoubleClickBugHandler",["require","exports"],function(y,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoubleClickBugHandler=void 0;class a{constructor(){this.clickObjectTimeTracker={}}isDoubleClickBug(g){const u=Date.now(),i=this.clickObjectTimeTracker[g];if(this.clickObjectTimeTracker[g]=u,i){const e=u-i;return console.log(e),e<900}}}t.DoubleClickBugHandler=a}),define("modules/LandinPageProxy",["require","exports","./DoubleClickBugHandler"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LandingPageProxy=void 0;class p{constructor(){this.windowObjectReference=null,this.doubleClickBugHandler=new a.DoubleClickBugHandler,this.isPreview=window.self==window.top&&window.location.hostname.includes(".preview.ceros")}sendUAEvent(u){if(window.self!==window.top){const i={event_category:"CEROS",event_label:u,event_action:"outbound_link_click"};parent.postMessage(JSON.stringify(i),"*")}else window.dataLayer.push({event:"ceros-event",cerosAction:"ceros_outbound_link_click",cerosCategory:"CEROS",cerosLabel:u}),this.openRequestedSingleTab(u)}openRequestedSingleTab(u){this.windowObjectReference===null||this.windowObjectReference.closed?this.windowObjectReference=window.open(u,"_blank"):(this.windowObjectReference=window.open(u,"_blank"),this.windowObjectReference.focus())}openAndTrackLink(u,i){this.doubleClickBugHandler.isDoubleClickBug(i)||(this.isPreview?this.openRequestedSingleTab(u):this.sendUAEvent(u))}}t.LandingPageProxy=p}),define("modules/moduleStrategies/ModuleHandler",["require","exports","../utils","../DoubleClickBugHandler"],function(y,t,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleHandler=void 0;class g{constructor(i,e,n){this.moduleName=i,this.experience=e,this.CerosSDK=n,this.moduleDict={},this.isNew=!1,this.doubleClickBugHandler=new p.DoubleClickBugHandler}static handleModuleImage(i,e){const n=e.image;(0,a.setImageUrl)(n,i)}updateModule(i,e,n,r,d){const s=(0,a.getModuleTag)(i,e,this.moduleName),l=this.experience.findLayersByTag(s);if(!l.layers.length){console.error(`No module found with tag: ${s}`);return}const h=l.layers[0].findAllComponents().layersByTag,c=i.toString();this.moduleDict[c]=this.moduleDict[c]||{},this.isNew=!this.moduleDict[c][s],this.moduleDict[c][s]||(this.moduleDict[c][s]={data:{},layers:{}}),this.moduleDict[c][s].data=n,this.moduleDict[c][s].layers=h,this.processLayers(h,s,d),r&&r(h,s),console.log(this.moduleDict),l.show()}showImageFromUrl(i,e,n,r){n.forEach(d=>{const s=this.getResultData(i);e(d,s.data),this.isNew&&d.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,l=>{const o=this.getResultData(i);e(l,o.data)}),r&&this.isNew&&d.on(this.CerosSDK.EVENTS.CLICKED,l=>{r(i)})})}updateResultTextbox(i,e,n,r){n.forEach(d=>{const s=this.getResultData(e),l=r?r(s.data[i]):s.data[i];d.setText(l),this.isNew&&d.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,o=>{const h=this.getResultData(e),c=r?r(h.data[i]):h.data[i];o.setText(c)})})}getResultData(i){const e=i.split("-")[0];return this.moduleDict[e][i]}hideModule(i,e){const n=(0,a.getModuleTag)(i,e,this.moduleName),r=this.experience.findLayersByTag(n);if(!r.layers.length){console.error(`No module found with tag: ${n}`);return}r.hide()}}t.ModuleHandler=g}),define("modules/moduleStrategies/ProductModuleHandler",["require","exports","../constants","./ModuleHandler","../utils"],function(y,t,a,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductModuleHandler=void 0;class u extends p.ModuleHandler{constructor(e,n,r,d,s,l){super(e,n,r),this.distributor=d,this.landingPageProxy=s,this.imgLrgLink=l,this.imgLargeHotspotCollection=this.experience.findComponentsByTag(`${a.IMG_LRG}-1`)}processLayers(e,n,r){e[a.IMAGE]&&this.showImageFromUrl(n,p.ModuleHandler.handleModuleImage,e[a.IMAGE],this.imageClickCallback.bind(this)),e[a.PART]&&this.updateResultTextbox(a.PART,n,e[a.PART]),e[a.SERIES]&&this.updateResultTextbox(a.SERIES,n,e[a.SERIES]),e[a.DATASHEET]&&this.registerResultClcikEvent(e[a.DATASHEET],a.DATASHEET,n),e[a.PRINT]&&this.registerResultClcikEvent(e[a.PRINT],a.PRINT,n),e[a.BUY_NOW]&&this.registerResultClcikEvent(e[a.BUY_NOW],this.distributor,n),e[a.PRODUCT_GUIDE]&&this.registerResultClcikEvent(e[a.PRODUCT_GUIDE],a.PRODUCT_GUIDE,n),e[a.SPECS]&&this.updateResultTextbox(a.SPECS,n,e[a.SPECS]),e[a.DESCRIPTION]&&this.updateResultTextbox(a.DESCRIPTION,n,e[a.DESCRIPTION]),e.pick&&this.handleLittelfusePick(e.pick,!!r)}handleLittelfusePick(e,n){n?e.forEach(r=>r.show()):e.forEach(r=>r.hide())}imageClickCallback(e){if(!(0,g.isMobile)(this.experience)){const n=this.getResultData(e);this.imgLrgLink.value=n.data.image,this.imgLargeHotspotCollection.click()}}registerResultClcikEvent(e,n,r){e.forEach(d=>{this.isNew?(d.on(this.CerosSDK.EVENTS.CLICKED,()=>{const s=this.getResultData(r);this.landingPageProxy.openAndTrackLink(s.data[n],d.id)}),d.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,s=>{this.getResultData(r).data[n]||s.hide()})):((0,g.isMobile)(this.experience)&&n===a.PRODUCT_GUIDE||n===this.distributor)&&(this.getResultData(r).data[n]?d.show():d.hide())})}}t.ProductModuleHandler=u}),define("modules/Carousel",["require","exports","./Observer","./DoubleClickBugHandler"],function(y,t,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Carousel=void 0;class g{constructor(i,e,n,r,d,s){this.max=i,this.name=e,this.CerosSDK=n,this.experience=r,this.moduleHandler=d,this.processOverlayLayers=s,this.currentPage=new a.NonStrictObservable(0),this.parts=[],this.next=this.experience.findLayersByTag(`${this.name}-next`),this.back=this.experience.findLayersByTag(`${this.name}-back`),this.backMask=this.experience.findLayersByTag(`${this.name}-mask-back`),this.nextMask=this.experience.findLayersByTag(`${this.name}-mask-next`),this.currentIndex=this.experience.findComponentsByTag(`${this.name}-current`),this.totalIndex=this.experience.findComponentsByTag(`${this.name}-total`),this.pages={},this.doubleClickBugHandler=new p.DoubleClickBugHandler,this.registerNavigationEvents()}init(i){this.pages={},this.parts=i,this.paginate(),this.setTotalPageIndex(),this.currentPage.value=1}paginate(){let i=0,e=1;for(;i<this.parts.length;){const n=i+this.max<this.parts.length?i+this.max:this.parts.length;this.pages[e]=this.parts.slice(i,n),i=i+this.max,e++}console.log(this.pages)}registerNavigationEvents(){this.next.on(this.CerosSDK.EVENTS.CLICKED,i=>{this.doubleClickBugHandler.isDoubleClickBug(i.id)||(this.currentPage.value++,console.log(this.currentPage.value))}),this.back.on(this.CerosSDK.EVENTS.CLICKED,i=>{this.doubleClickBugHandler.isDoubleClickBug(i.id)||this.currentPage.value--}),this.currentPage.subscribe(()=>{this.hideModules(),this.updatePageIndex(),this.populate(),this.isLastPage()?(this.nextMask.show(),this.backMask.hide()):this.isFirstPage()?(this.backMask.show(),this.nextMask.hide()):(this.backMask.hide(),this.nextMask.hide())})}populate(){let i=0;const e=this.pages[this.currentPage.value];for(;i<this.max&&i<e.length;){const n=e[i];if(n){const r=this.currentPage.value===1;this.moduleHandler.updateModule(this.max,i,n,this.processOverlayLayers,r)}i++}}hideModules(){let i=0;for(;i<this.max;)this.moduleHandler.hideModule(this.max,i),i++}updatePageIndex(){this.currentIndex.components.forEach(i=>i.setText(this.currentPage.value.toString()))}setTotalPageIndex(){const i=Object.keys(this.pages);this.totalIndex.components.forEach(e=>e.setText(i[i.length-1]))}isLastPage(){const i=Object.keys(this.pages);return this.currentPage.value===Number(i[i.length-1])}isFirstPage(){return this.currentPage.value===1}}t.Carousel=g}),define("modules/moduleStrategies/NavModuleHandler",["require","exports","./ModuleHandler"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavModuleHandler=void 0;class p extends a.ModuleHandler{constructor(u,i,e,n,r){super(u,i,e),this.currentSegment=n,this.textFormat=r}processLayers(u,i){u.name&&this.updateResultTextbox("name",i,u.name,this.textFormat),u.cta&&this.registerTabChangeCta("name",i,u.cta)}selectTab(u,i){const e=this.moduleDict[i];for(const n in e){const r=e[n];r.data.name===u&&r.layers.cta.forEach(d=>{d.click(),console.log(`clicked ${u}`)})}}registerTabChangeCta(u,i,e){e.forEach(n=>{n.on(this.CerosSDK.EVENTS.CLICKED,r=>{if(this.doubleClickBugHandler.isDoubleClickBug(r.id))return;const d=this.getResultData(i);this.currentSegment.value=d.data[u]})})}}t.NavModuleHandler=p}),define("modules/moduleStrategies/TabNavHandler",["require","exports","./NavModuleHandler","../Observer","../constants"],function(y,t,a,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabNavHandler=void 0;class u{constructor(e,n,r,d,s,l,o){this.experience=e,this.CerosSDK=n,this.showResultModule=r,this.tabTag=d,this.tabTextTag=s,this.tabKey=l,this.textFormat=o,this.segments={},this.currentSegment=new p.NonStrictObservable(""),this.navModuleHandler=new a.NavModuleHandler(d,e,n,this.currentSegment,this.textFormat),this.tabTextComponentCollection=e.findComponentsByTag(s),this.subscribeToSegmentChange()}init(e){this.segments={},this.mapSegments(e.children)}subscribeToSegmentChange(){this.currentSegment.subscribe(this.displayModules.bind(this)),this.currentSegment.subscribe(this.updateFuseTypeInfo.bind(this))}display(){this.updateNavigation(),this.triggerHotspot(this.tabTag,Object.keys(this.segments).length,3);const e=Object.keys(this.segments)[0];this.navModuleHandler.selectTab(e,Object.keys(this.segments).length.toString())}mapSegments(e){e.forEach(n=>{const r=n.data[this.tabKey].trim();this.segments[r]=this.segments[r]||{},this.segments[r].nodes=this.segments[r].nodes||[],this.segments[r].nodes.push(n)})}displayModules(){const e=this.segments[this.currentSegment.value]?this.segments[this.currentSegment.value].nodes.length:0;e?this.showResultModule(e,this.segments[this.currentSegment.value].nodes):console.log("No options in segement "+this.currentSegment.value)}updateFuseTypeInfo(){const e=this.segments[this.currentSegment.value].nodes[0].data[this.tabTextTag];this.tabTextComponentCollection.setText(e)}updateNavigation(){const e=Object.keys(this.segments).length;e&&(this.updateNavModules(e),this.triggerHotspot(this.tabTag,e,g.MAX_TABS))}updateNavModules(e){Object.keys(this.segments).forEach((r,d)=>{this.navModuleHandler.updateModule(e,d,{name:r})})}triggerHotspot(e,n,r){this.experience.findComponentsByTag(`${e}-${n<=r?n:`${r+1}+`}`).click()}isOneTab(e){const n=e[0].data[this.tabKey];return e.every(r=>r.data[this.tabKey]===n)}}t.TabNavHandler=u});var __awaiter=this&&this.__awaiter||function(y,t,a,p){function g(u){return u instanceof a?u:new a(function(i){i(u)})}return new(a||(a=Promise))(function(u,i){function e(d){try{r(p.next(d))}catch(s){i(s)}}function n(d){try{r(p.throw(d))}catch(s){i(s)}}function r(d){d.done?u(d.value):g(d.value).then(e,n)}r((p=p.apply(y,t||[])).next())})};define("modules/ResultHandler",["require","exports","./constants","./LandinPageProxy","./moduleStrategies/ProductModuleHandler","./DoubleClickBugHandler","./Carousel","./moduleStrategies/TabNavHandler","./utils"],function(y,t,a,p,g,u,i,e,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResultHandler=void 0;class r{constructor(s,l,o,h,c,f,m,S){this.experience=s,this.CerosSDK=l,this.currentNodeObservable=o,this.distributor=h,this.relatedProductsLink=c,this.accessoriesLink=f,this.PapaParse=m,this.imgLrgLink=S,this.csvData={"related products":{},accessories:{}},this.maxResultItems=a.MAX_RESULTS,this.maxRelatedProducts=a.MAX_RELATED_PRODUCTS,this.maxAccessories=a.MAX_ACCESSORIES,this.doubleClickBugHandler=new u.DoubleClickBugHandler,(0,n.isMobile)(s)&&(this.maxResultItems=a.MOBILE_MAX_ITEMS,this.maxRelatedProducts=a.MOBILE_MAX_ITEMS,this.maxAccessories=a.MOBILE_MAX_ITEMS),this.pathNavigationCollection=s.findLayersByTag(`nav:${a.PART}`),this.landingPageProxy=new p.LandingPageProxy,this.resultModulesHandler=new g.ProductModuleHandler(a.RESULTS,s,l,h,this.landingPageProxy,this.imgLrgLink),this.relatedProductsModulesHandler=new g.ProductModuleHandler(a.RELATED_PRODUCTS,s,l,h,this.landingPageProxy,this.imgLrgLink),this.accessoriesModulesHandler=new g.ProductModuleHandler(a.ACCESSORIES,s,l,h,this.landingPageProxy,this.imgLrgLink),this.accessoriesCarousel=new i.Carousel(this.maxAccessories,a.ACCESSORIES,l,s,this.accessoriesModulesHandler),this.relatedProductsCarousel=new i.Carousel(this.maxRelatedProducts,a.RELATED_PRODUCTS,l,s,this.relatedProductsModulesHandler),this.resultsCarousel=new i.Carousel(this.maxResultItems,a.RESULTS,l,s,this.resultModulesHandler,this.processOverlayLayers.bind(this)),this.tabNavHandler=new e.TabNavHandler(this.experience,this.CerosSDK,this.showPath2Results.bind(this),a.TAB,"","max current",this.formatTabText)}formatTabText(s){return`${s}A`}displayPathNavigation(s){this.pathNavigationCollection.layers.forEach(l=>{l.getPayload().trim()===s?l.show():l.hide()})}showResultModule(s,l){l===a.PATH2?(this.tabNavHandler.init(this.currentNodeObservable.value),this.tabNavHandler.isOneTab(this.currentNodeObservable.value.children)&&this.showPath1Results(s),this.tabNavHandler.display()):this.showPath1Results(s)}showPath1Results(s){this.updateResultModules(s,this.currentNodeObservable.value.children),this.triggerHotspot(a.RESULTS,s,this.maxResultItems)}showPath2Results(s,l){this.updateResultModules(s,l),this.triggerHotspot(a.RESULTS,s,this.maxResultItems)}sortNodesBySales(s){return s.sort((l,o)=>{const h=isNaN(Number(l.data.sales))?0:Number(l.data.sales);return(isNaN(Number(o.data.sales))?0:Number(o.data.sales))-h})}updateResultModules(s,l){const o=this.sortNodesBySales(l);o.length<=this.maxResultItems?o.forEach((h,c)=>{this.resultModulesHandler.updateModule(s,c,h.data,this.processOverlayLayers.bind(this))}):this.resultsCarousel.init(o.map(h=>h.data))}processOverlayLayers(s,l){s[a.RELATED_PRODUCTS]&&this.handleOverlay(a.RELATED_PRODUCTS,s[a.RELATED_PRODUCTS],l,this.relatedProductsLink),s[a.ACCESSORIES]&&this.handleOverlay(a.ACCESSORIES,s[a.ACCESSORIES],l,this.accessoriesLink)}updateRelatedProductsModules(s){s.length<=this.maxRelatedProducts?s.forEach((l,o)=>{this.relatedProductsModulesHandler.updateModule(s.length,o,l)}):this.relatedProductsCarousel.init(s)}updateAccessoriesModules(s){s.length<=this.maxAccessories?s.forEach((l,o)=>{this.accessoriesModulesHandler.updateModule(s.length,o,l)}):this.accessoriesCarousel.init(s)}handleOverlay(s,l,o,h){l.forEach(c=>{this.resultModulesHandler.isNew?(this.registerOverlayAnimation(c,o,s),this.registerOverlayClick(c,o,s,h)):this.handleButtonDisplay(c,o,s)})}handleButtonDisplay(s,l,o){if(this.getPartNumbers(l,o).length===0)s.hide();else if(o===a.ACCESSORIES){const c=!!this.getPartNumbers(l,a.RELATED_PRODUCTS).length,f=!!this.getValue(l,a.PRODUCT_GUIDE);c||f?s.getTags().find(m=>m==="pos:1")?s.hide():s.show():s.getTags().find(m=>m==="pos:2")?s.hide():s.show()}else s.show()}registerOverlayAnimation(s,l,o){s.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,h=>{if(this.getPartNumbers(l,o).length===0)h.hide();else if(o===a.ACCESSORIES){const f=!!this.getPartNumbers(l,a.RELATED_PRODUCTS).length,m=!!this.getValue(l,a.PRODUCT_GUIDE);f||m?h.getTags().find(S=>S==="pos:1")&&h.hide():h.getTags().find(S=>S==="pos:2")&&h.hide()}})}registerOverlayClick(s,l,o,h){s.on(this.CerosSDK.EVENTS.CLICKED,c=>__awaiter(this,void 0,void 0,function*(){if(this.doubleClickBugHandler.isDoubleClickBug(c.id))return;const f=this.getPartNumbers(l,o);if(!f.length)return;yield this.loadCsvData(o,h);const m=this.getExistingParts(o,f);m.length&&(o===a.RELATED_PRODUCTS?(this.updateRelatedProductsModules(m),this.triggerHotspot(o,m.length,this.maxRelatedProducts)):o===a.ACCESSORIES&&(this.updateAccessoriesModules(m),this.triggerHotspot(o,m.length,this.maxAccessories)))}))}triggerHotspot(s,l,o){this.experience.findComponentsByTag(`${s}-${l<=o?l:`${o+1}+`}`).click()}getPartNumbers(s,l){const o=this.getValue(s,l);return o?o.split(a.DIVIDER).map(h=>h.replace(" ","")):[]}getValue(s,l){return this.resultModulesHandler.getResultData(s).data[l]}getExistingParts(s,l){const o=[];return l.forEach(h=>{this.csvData[s][h]?o.push(this.csvData[s][h]):console.error(`could not find part: ${h} from ${s}!`)}),o}loadCsvData(s,l){return new Promise((o,h)=>{this.csvData[s]&&Object.keys(this.csvData[s]).length>0?o(this.csvData[s]):this.PapaParse.parse(l,{header:!0,download:!0,complete:c=>{const f=this.indexByPartNumber(c.data);this.csvData[s]=f,o(this.csvData[s])},error:c=>h(c)})})}indexByPartNumber(s){const l={};return s.forEach(o=>{l[o.part.trim()]=o}),l}}t.ResultHandler=r}),define("modules/questionStrategies/QuestionStrategy",["require","exports","../constants","../Observer"],function(y,t,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionStrategy=void 0;class g{constructor(i,e,n){this.name=i,this.experience=e,this.CerosSDK=n,this.key="value",this.optionsCollection=e.findComponentsByTag(`q:${i}`),this.pathNavigationCollection=e.findLayersByTag(`nav:${i}`),this.selectedOption=new p.NonStrictObservable(`${i}:${this.key}:`)}displayPathNavigation(i){i===a.PATH2?this.experience.findComponentsByTag("show-path2-nav").click():this.experience.findComponentsByTag("show-path1-nav").click()}}t.QuestionStrategy=g}),define("modules/questionStrategies/MaskingOptionsStrategy",["require","exports","./QuestionStrategy"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaskingOptionsStrategy=void 0;class p extends a.QuestionStrategy{constructor(u,i,e,n){super(u,i,e),this.currentNodeObservable=n,this.key="value",this.maskCollection=this.experience.findLayersByTag(`mask:${this.name}`),this.registerCerosEvents(),this.registerMaskAnimations()}registerCerosEvents(){this.optionsCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleOptionClick.bind(this))}handleOptionClick(u){const i=u.getPayload().trim()||"",e=this.selectedOption.value.split(":");e[1]=this.key,e[2]=i,this.selectedOption.value=e.join(":")}displayAnswerOptions(u){this.maskCollection.layers.forEach(i=>{u.findChildByValueProperty(i.getPayload().trim())?i.hide():i.show()})}handleMasks(u,i){i.findChildByValueProperty(u.getPayload().trim())&&u.hide()}registerMaskAnimations(){this.maskCollection.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,u=>{this.handleMasks(u,this.currentNodeObservable.value)})}}t.MaskingOptionsStrategy=p}),define("modules/questionStrategies/MaskOptionsStrateyWithMultipleCellValues",["require","exports","./MaskingOptionsStrategy"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaskingOptionsStrategyWithMultipleCellValues=void 0;class p extends a.MaskingOptionsStrategy{handleMasks(u,i){i.findChildThatIncludesValue(u.getPayload().trim())?u.hide():u.show()}}t.MaskingOptionsStrategyWithMultipleCellValues=p}),define("modules/questionStrategies/MaskingOptionsWithSubCategoriesStrategy",["require","exports","./MaskingOptionsStrategy"],function(y,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaskingOptionsWithSubcategoriesStrategy=void 0;class p extends a.MaskingOptionsStrategy{displayAnswerOptions(u){console.log(u.name),this.experience.findLayersByTag(`cat:${u.children[0].name}`).layers.forEach(e=>{e.getPayload().trim()===u.value?e.show():e.hide()}),this.maskCollection.layers.forEach(e=>{this.handleMasks(e,u)})}}t.MaskingOptionsWithSubcategoriesStrategy=p}),define("modules/questionStrategies/HidingOptionsStrategy",["require","exports","./QuestionStrategy","../utils"],function(y,t,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HidingOptionsStrategy=void 0;class g extends a.QuestionStrategy{constructor(i,e,n){super(i,e,n),this.key="elementId",this.isMobile=(0,p.isMobile)(e),this.isTablet=this.experience.findComponentsByTag("tablet").components.length>0,this.evenOptions=this.experience.findLayersByTag(`${i.toLowerCase()}_even`),this.oddOptions=this.experience.findLayersByTag(`${i.toLowerCase()}_odd`),this.registerCerosEvents()}registerCerosEvents(){this.optionsCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleOptionClick.bind(this))}handleOptionClick(i){const e=i.id,n=this.selectedOption.value.split(":");n[1]=this.key,n[2]=e,this.selectedOption.value=n.join(":")}displayAnswerOptions(i){const e=i.children.sort((n,r)=>Number(n.value)-Number(r.value));if(this.isMobile||this.isTablet){console.log("MOBILE LAYOUT!");let n=[],r=[];e.length===4?(n=e.slice(0,2),r=e.slice(2)):(n=e.slice(0,3),r=e.slice(3)),this.displayMobileLayoutOptions(n,1),r.length?this.displayMobileLayoutOptions(r,2):this.hideMobileOptionsRow(2)}else this.displayLayoutOptions(e,this.handleTextOptions.bind(this))}hideMobileOptionsRow(i){const e=this.experience.findLayersByTag(`${this.name}-${i}-odd`),n=this.experience.findLayersByTag(`${this.name}-${i}-even`);e.hide(),n.hide()}displayMobileLayoutOptions(i,e){const n=this.experience.findLayersByTag(`${this.name}-${e}-odd`),r=this.experience.findLayersByTag(`${this.name}-${e}-even`);i.length%2===0?(n.hide(),r.show(),this.handleMobileTextOptions(r,i)):(n.show(),r.hide(),this.handleMobileTextOptions(n,i))}displayLayoutOptions(i,e){i.length%2===0?(this.oddOptions.hide(),this.evenOptions.show(),e(this.evenOptions,i)):(this.oddOptions.show(),this.evenOptions.hide(),e(this.oddOptions,i))}handleTextOptions(i,e){const n=i.layers[0].findAllComponents(),r=n.layersByTag.answer.length,d=Math.floor((r-e.length)/2);let s=0;n.components.forEach(l=>{if(l.type==="text"){const o=s-d;s>=d&&o<e.length?(l.setText(e[o].value),e[o].elementId=l.id):l.hide(),s++}else l.type==="line"&&this.handleLineDivider(l,d,e)})}handleLineDivider(i,e,n){const r=Number(i.getPayload());r?r>e&&r-e<n.length||i.hide():console.error(`there is no position number in payload of divider line with id ${i.id} in question ${n[0].name}`)}handleMobileTextOptions(i,e){const n=i.layers[0].findAllComponents();e.length===1?this.handleOneOptionInMobileView(e,n):this.handleTextOptions(i,e)}handleOneOptionInMobileView(i,e){let n=0;e.layers.forEach(r=>{r.type==="text"?(n===1?(r.setText(i[0].value),i[0].elementId=r.id):r.hide(),n++):r.hide()})}}t.HidingOptionsStrategy=g}),define("modules/questionStrategies/SliderOptionsStrategy",["require","exports","../Observer","./QuestionStrategy"],function(y,t,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SliderOptionsStrategy=void 0;class g extends p.QuestionStrategy{constructor(i,e,n){super(i,e,n),this.currentIndex=new a.Observable(0),this.sliderValues=[],this.nextButtonMask=e.findLayersByTag(`${i}-mask`),this.nextButton=e.findLayersByTag(`${i}-next`),this.singleOptionCollection=e.findLayersByTag("single-option"),this.sliderContainer=document.getElementById("slider-container"),this.output=document.getElementById("slider-value"),this.slider=null,this.registerCerosEvents(),this.subscribeToObservables()}subscribeToObservables(){this.currentIndex.subscribe(this.handleNextButtonDisplay.bind(this)),this.currentIndex.subscribe(this.updateSliderBackground.bind(this)),this.currentIndex.subscribe(this.updateSliderValuePosition.bind(this))}registerCerosEvents(){this.optionsCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleOptionClick.bind(this))}handleNextButtonDisplay(i){i>0?(this.nextButtonMask.hide(),this.nextButton.show()):(this.nextButton.hide(),this.nextButtonMask.show())}handleOptionClick(i){const e=this.sliderValues.length===2?this.sliderValues[1].toString():this.sliderValues[this.currentIndex.value].toString(),n=this.selectedOption.value.split(":");n[1]=this.key,n[2]=e,this.selectedOption.value=n.join(":")}getSliderContainer(){return this.sliderContainer}getOutput(){return this.output}displayAnswerOptions(i){const e=i.children.map(n=>Number(n.value));if(this.slider&&(this.slider.remove(),this.slider=null),this.sliderContainer&&this.output)this.displayOutput(e,this.sliderContainer,this.output);else{const n=setInterval(()=>{const r=document.getElementById("slider-container"),d=document.getElementById("slider-value");r&&d&&(clearInterval(n),this.sliderContainer=r,this.output=d,this.displayOutput(e,this.sliderContainer,this.output))},200)}}displayOutput(i,e,n){this.sliderValues=[0,...i],console.log(this.sliderValues),i.length>1?(this.singleOptionCollection.hide(),this.displaySlider(e,n),this.slider&&(this.currentIndex.value=0,this.slider.style.display="block",this.output&&(this.output.style.display="block"),this.handleNextButtonDisplay(this.currentIndex.value))):(this.slider&&(this.slider.style.display="none"),this.output&&(this.output.style.display="none"),this.nextButton.hide(),this.nextButtonMask.hide(),this.experience.findLayersByTag("slider-info").hide(),this.displaySingleOption(i))}displaySingleOption(i){this.singleOptionCollection.layers.forEach(e=>e.setText(`${i[0]}`)),this.singleOptionCollection.show()}displaySlider(i,e){this.registerNewSlider(i,e)}registerNewSlider(i,e){const n=this.getSlider(i);this.slider=n,this.slider.addEventListener("input",r=>{const d=r.target;d&&!isNaN(Number(d.value))&&(this.currentIndex.value=parseInt(d.value,10))}),this.updateSliderValuePosition()}updateSliderValuePosition(){if(console.log(`index: ${this.currentIndex.value}`),console.log(`value: ${this.sliderValues[this.currentIndex.value]}`),this.slider&&this.output){const i=this.currentIndex.value/(this.sliderValues.length-1),e=this.slider.offsetWidth,n=32,r=this.slider.offsetLeft,d=i*(e-n)+n/2;this.output.style.left=`${r+d}px`,this.output.textContent=this.currentIndex.value===0?"A":`${this.sliderValues[this.currentIndex.value]}A`}}updateSliderBackground(){if(this.slider){const i=this.currentIndex.value/(this.sliderValues.length-1)*100;if("WebkitAppearance"in document.documentElement.style){const n=`linear-gradient(
        to right,
        #5CC883 0%,
        #008752 ${i}%,
        #ccc ${i}%,
        #ccc 100%
      )`;this.slider.style.background=n}}}getSlider(i){const e=i.querySelector("#customSlider");if(e)return e;{const n=this.createSlider(this.sliderValues.length-1);return i.prepend(n),n}}createSlider(i){const e=document.createElement("input");return e.type="range",e.id="customSlider",e.min="0",e.max=i.toString(),e.value="0",e}}t.SliderOptionsStrategy=g}),define("modules/moduleStrategies/PartModuleHandler",["require","exports","./ModuleHandler","../constants","../utils"],function(y,t,a,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartModuleHandler=void 0;class u extends a.ModuleHandler{constructor(e,n,r,d,s){super(e,n,r),this.qName=d,this.selectedOption=s}processLayers(e,n){console.log("proccessing part layers"),e[p.IMAGE]&&this.showImageFromUrl(n,this.displayPartImage.bind(this),e[p.IMAGE]),e[this.qName]&&this.updateResultTextbox(this.qName,n,e[this.qName]),e[p.FUSE_STYLE_INFO]&&this.updateResultTextbox(p.FUSE_STYLE_INFO,n,e[p.FUSE_STYLE_INFO]),e[`q:${this.qName}`]&&this.registerOptionClick(this.qName,n,e[`q:${this.qName}`])}registerOptionClick(e,n,r){r.forEach(d=>{d.on(this.CerosSDK.EVENTS.CLICKED,()=>{const l=this.getResultData(n).data[e],o=this.selectedOption.value.split(":");o[2]=l,this.selectedOption.value=o.join(":")})})}displayPartImage(e,n){const r=n[`${this.qName.split("-")[0]} image`];(0,g.setImageUrl)(r,e)}}t.PartModuleHandler=u}),define("modules/questionStrategies/SegmentedOptionsStrategy",["require","exports","../constants","../moduleStrategies/PartModuleHandler","./QuestionStrategy","../moduleStrategies/TabNavHandler","../Carousel","../utils"],function(y,t,a,p,g,u,i,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentedOptionsStrategy=void 0;class n extends g.QuestionStrategy{constructor(d,s,l){super(d,s,l),this.maxParts=3,this.partModuleHandler=new p.PartModuleHandler(a.PARTS,s,l,d,this.selectedOption),this.tabNavHandler=new u.TabNavHandler(s,l,this.showResultModules.bind(this),a.SEGMENTS,a.FUSE_TYPE_INFO,`fuse type-${a.PATH2}`),this.maxParts=(0,e.isMobile)(s)?a.MOBILE_MAX_ITEMS:3,this.partsCarousel=new i.Carousel(this.maxParts,a.PARTS,l,s,this.partModuleHandler)}displayAnswerOptions(d){this.tabNavHandler.init(d),this.tabNavHandler.display()}showResultModules(d,s){this.updateResultModules(d,s),this.triggerHotspot(a.PARTS,d,this.maxParts)}updateResultModules(d,s){d<=this.maxParts?s.forEach((l,o)=>{this.partModuleHandler.updateModule(d,o,l.data)}):this.partsCarousel.init(s.map(l=>l.data))}triggerHotspot(d,s,l){this.experience.findComponentsByTag(`${d}-${s<=l?s:`${l+1}+`}`).click()}}t.SegmentedOptionsStrategy=n}),define("modules/questionStrategies/QuestionStrategyFactory",["require","exports","./MaskingOptionsStrategy","./MaskOptionsStrateyWithMultipleCellValues","./MaskingOptionsWithSubCategoriesStrategy","./HidingOptionsStrategy","./SliderOptionsStrategy","./SegmentedOptionsStrategy"],function(y,t,a,p,g,u,i,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionStrategyFactory=void 0;class n{static create(d,s,l,o,h){switch(s.questionStrategy){case"hiding":return new u.HidingOptionsStrategy(d,l,h);case"masking-with-subcategories":return new g.MaskingOptionsWithSubcategoriesStrategy(d,l,h,o);case"masking-with-mulitiple-cell-values":return new p.MaskingOptionsStrategyWithMultipleCellValues(d,l,h,o);case"slider":return new i.SliderOptionsStrategy(d,l,h);case"segments":return new e.SegmentedOptionsStrategy(d,l,h);case"masking":default:return new a.MaskingOptionsStrategy(d,l,h,o)}}}t.QuestionStrategyFactory=n});var __awaiter=this&&this.__awaiter||function(y,t,a,p){function g(u){return u instanceof a?u:new a(function(i){i(u)})}return new(a||(a=Promise))(function(u,i){function e(d){try{r(p.next(d))}catch(s){i(s)}}function n(d){try{r(p.throw(d))}catch(s){i(s)}}function r(d){d.done?u(d.value):g(d.value).then(e,n)}r((p=p.apply(y,t||[])).next())})};define("modules/QuizContext",["require","exports","./constants","./lib/NodeTree","./Observer","./utils","./ResultHandler","./DoubleClickBugHandler","./moduleStrategies/ProductModuleHandler","./questionStrategies/QuestionStrategyFactory","./moduleStrategies/ModuleHandler"],function(y,t,a,p,g,u,i,e,n,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuizContext=void 0;class s{constructor(o,h,c,f,m,S,b,C){this.CerosSDK=o,this.experience=h,this.distributor=f,this.relatedProductsLink=m,this.accessoriesLink=S,this.PapaParse=b,this.path2Link=C,this.questions={},this.imgLargeOverlayCollection=this.experience.findLayersByTag(a.IMG_LRG),this.imgLrgLink=new g.Observable(""),this.imgLrgCloseHotspotCollection=this.experience.findLayersByTag(`${a.IMG_LRG}-close`),this.path2NodeTree=null,this.currentTree=c,this.path1NodeTree=c,this.currentNode=new g.Observable(c.root),this.backLayersCollection=this.experience.findLayersByTag(a.BACK),this.navCollecttion=this.experience.findComponentsByTag(a.NAV),this.pathTextCollection=this.experience.findComponentsByTag(a.PATH),this.resetCollection=this.experience.findLayersByTag(a.RESET),this.mcaseAdapterCtaCollection=this.experience.findLayersByTag(`${a.MCASE_ADAPTER}-cta`),this.resultHandler=new i.ResultHandler(h,o,this.currentNode,f,m,S,b,this.imgLrgLink),this.mcaseAdapterModuleHandler=new n.ProductModuleHandler(a.MCASE_ADAPTER,h,o,f,this.resultHandler.landingPageProxy,this.imgLrgLink),this.doubleClickHandler=new e.DoubleClickBugHandler,this.init()}init(){this.subscribeCurrentNodeObserver(),this.subscribeToCerosEvents(),this.assignQuestionsStrategy(),this.registerImageOverlay()}registerImageOverlay(){this.imgLargeOverlayCollection.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,o=>{d.ModuleHandler.handleModuleImage(o,{image:this.imgLrgLink.value})}),this.imgLrgCloseHotspotCollection.on(this.CerosSDK.EVENTS.CLICKED,()=>{this.imgLrgLink.value=""}),this.imgLrgLink.subscribe(o=>{this.imgLargeOverlayCollection.layers.forEach(h=>{d.ModuleHandler.handleModuleImage(h,{image:o})})})}subscribeCurrentNodeObserver(){this.currentNode.subscribe(this.handleNodeChange.bind(this)),this.currentNode.subscribe(this.updatePath.bind(this))}assignQuestionsStrategy(){for(const o in a.fieldNodesDict){const h=a.fieldNodesDict[o];if(h.type==="question"){const c=r.QuestionStrategyFactory.create(o,h,this.experience,this.currentNode,this.CerosSDK);this.questions[o]=c,c.selectedOption.subscribe(this.handleSelectedAnswer.bind(this))}}}subscribeToCerosEvents(){this.backLayersCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleBackNavigation.bind(this)),this.navCollecttion.on(this.CerosSDK.EVENTS.CLICKED,this.handleRandomNavigation.bind(this)),this.resetCollection.on(this.CerosSDK.EVENTS.CLICKED,this.resetQuiz.bind(this)),this.mcaseAdapterCtaCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleMcaseAdapter.bind(this))}handleMcaseAdapter(o){return __awaiter(this,void 0,void 0,function*(){if(this.doubleClickHandler.isDoubleClickBug(o.id))return;const h=o.getPayload().trim();yield this.resultHandler.loadCsvData(a.RELATED_PRODUCTS,this.relatedProductsLink);const c=this.resultHandler.csvData[a.RELATED_PRODUCTS][h];c?(this.mcaseAdapterModuleHandler.updateModule(1,0,c),this.experience.findComponentsByTag(`${a.MCASE_ADAPTER}-1`).click()):console.error(`Could not find part ${h} in related products sheet`)})}resetQuiz(){this.currentNode.value=this.currentTree.root}handleSelectedAnswer(o){return __awaiter(this,void 0,void 0,function*(){const[h,c,f]=o.split(":");h==="fuse type"&&(f.toLowerCase()==="guide me"?this.currentTree=yield this.loadCsvDataIntoNodeTree():this.currentTree=this.path1NodeTree,this.currentNode.value=this.currentTree.root);const m=this.currentTree.findChild(this.currentNode.value,c,f);m?this.updateCurrentNodeValue(m,h,f):console.error(`coudn't find node with ${h} and value ${f}`)})}updateCurrentNodeValue(o,h,c){a.fieldNodesDict[h].skipif&&a.fieldNodesDict[h].skipif.find(f=>f===c)&&o.children.length?this.currentNode.value=o.children[0]:this.currentNode.value=o}loadCsvDataIntoNodeTree(){if(this.path2NodeTree)return Promise.resolve(this.path2NodeTree);const o=new p.NodeTree(a.fieldNodesDict);return new Promise((h,c)=>{this.PapaParse.parse(this.path2Link,{header:!0,download:!0,complete:f=>{o.buildTree(f.data,a.path2Fields),o.mergeDataWithFields(this.path1NodeTree,o.root,a.transitionFields),this.path2NodeTree=o,h(o)},error:f=>c(f)})})}handleBackNavigation(o){if(this.doubleClickHandler.isDoubleClickBug(o.id))return;const h=this.currentNode.value,c=h.parent;if(!c)return;const f=h.name;console.log(`clicked back to ${h.name}`);const m=a.fieldNodesDict[f];if(m&&m.skipBackIf){const S=m.skipBackIf,b=Object.keys(S)[0],C=S[b],T=h.findParentByName(b);if(T&&C.find(E=>E===T.value)){this.currentNode.value=c.parent||c;return}}this.currentNode.value=c}handleRandomNavigation(o){if(this.doubleClickHandler.isDoubleClickBug(o.id))return;const h=o.getPayload().toLowerCase(),c=this.currentNode.value.findParentByName(h);c&&c.parent?this.currentNode.value=c.parent:console.error(`Could not find node ${h} or it's parent`)}handleNodeChange(o){if(o.children.length){if(this.isLastQuestion(o)){const h=this.currentTree===this.path1NodeTree?a.PATH1:a.PATH2;this.resultHandler.showResultModule(o.children.length,h),this.handlePathNavigation(this.resultHandler)}else{const h=o.children[0].name.toLowerCase(),c=this.questions[h];c&&(c.displayAnswerOptions(o),this.handlePathNavigation(c))}console.log(this.currentNode.value)}}handlePathNavigation(o){this.currentTree===this.path2NodeTree?o.displayPathNavigation(a.PATH2):o.displayPathNavigation(a.PATH1)}updatePath(o){let h=o;const c=[];h.getPath().forEach(({name:m,value:S})=>{if(m==="Root")return;const C=(m==="fuse type"&&this.currentTree===this.path2NodeTree?"{{}}":a.fieldNodesDict[m].pathText).replace("{{}}",(0,u.capitalize)(S));c.push(C)}),c.length?this.pathTextCollection.setText(c.join("  >  ")):this.pathTextCollection.setText(""),this.pathTextCollection.show()}isLastQuestion(o){return o.children[0].name==="part"}}t.QuizContext=s});const script=document.getElementById("fuse-holders");if(script===null)throw Error("Could not find script fuse-holders");const link=script.getAttribute("data-link")||"",distributor=script.getAttribute("data-distributor")||"",relatedProductsLink=script.getAttribute("data-related-products")||"",accessoriesLink=script.getAttribute("data-accessories")||"",path2Link=script.getAttribute("data-path2")||"";typeof require<"u"&&typeof require=="function"&&(require.config({baseUrl:"http://127.0.0.1:5173/",paths:{CerosSDK:"//sdk.ceros.com/standalone-player-sdk-v5.min",PapaParse:"https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min"}}),require(["CerosSDK","PapaParse","modules/QuizContext","modules/lib/NodeTree","modules/constants","modules/utils"],function(y,t,a,p,g,u){y.findExperience().done(i=>{const e=u.stepsFromFieldNames(g.path1Fields,g.fieldNodesDict),n=new p.NodeTree(e);t.parse(link,{download:!0,header:!0,complete:r=>{n.buildTree(r.data,g.path1Fields),new a.QuizContext(y,i,n,distributor,relatedProductsLink,accessoriesLink,t,path2Link)}})}).fail(i=>{console.log(i)})})),define("main",function(){});
