"use strict";define("modules/constants",["require","exports"],function(C,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_IMAGE=i.IMG_LRG=i.MCASE_ADAPTER=i.MAX_RESULTS=i.MAX_ACCESSORIES=i.MAX_RELATED_PRODUCTS=i.DIVIDER=i.RESULTS=i.ACCESSORIES=i.RELATED_PRODUCTS=i.NAV=i.BACK=i.PATH=i.PRODUCT_GUIDE=i.BUY_NOW=i.PRINT=i.DATASHEET=i.DESCRIPTION=i.IMAGE=i.PART=i.SERIES=i.SPECS=i.DELIMETER=i.RESET=i.QUESTION=i.OPTION=i.fieldNodesDict=void 0,i.fieldNodesDict={"fuse type":{type:"question",pathText:"Fuse Type: {{}}"},"fuse style":{type:"question",pathText:"Fuse Style: {{}}",questionStrategy:"masking-with-subcategories"},"max voltage":{type:"question",pathText:"Volts: {{}}V DC",questionStrategy:"hiding"},"max current":{type:"question",pathText:"Amps: {{}}A",questionStrategy:"hiding"},"circuit option":{type:"question",pathText:"Circuit Option: {{}}",questionStrategy:"masking"},style:{type:"question",pathText:"Style: {{}}",questionStrategy:"masking",skipif:["PCBA","Fuse Block"]},"mounting method":{type:"question",pathText:"Mounting: {{}}",questionStrategy:"masking-with-subcategories",skipBackIf:{style:["PCBA","Fuse Block"]}},protection:{type:"question",pathText:"Protection: {{}}",questionStrategy:"masking"},part:{type:"result",pathText:""}},i.OPTION="answer",i.QUESTION="q",i.RESET="reset",i.DELIMETER=":",i.SPECS="specs",i.SERIES="series",i.PART="part",i.IMAGE="img",i.DESCRIPTION="description",i.DATASHEET="datasheet",i.PRINT="2d print",i.BUY_NOW="buy-now",i.PRODUCT_GUIDE="product guide",i.PATH="path",i.BACK="back",i.NAV="nav",i.RELATED_PRODUCTS="related products",i.ACCESSORIES="accessories",i.RESULTS="module",i.DIVIDER=";",i.MAX_RELATED_PRODUCTS=2,i.MAX_ACCESSORIES=4,i.MAX_RESULTS=5,i.MCASE_ADAPTER="mcase-adapter",i.IMG_LRG="img lrg",i.DEFAULT_IMAGE="https://ceros-projects.s3.us-east-2.amazonaws.com/littlefuse/fuse-holders/Image+Not+Available.jpg"}),define("modules/Observer",["require","exports"],function(C,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Observable=i.Observer=void 0;class s{constructor(){this.subscribers=new Set}subscribe(e){this.subscribers.add(e)}notify(e){this.subscribers.forEach(t=>t(e))}}i.Observer=s;class h extends s{constructor(e){super(),this._value=e}get value(){return this._value}set value(e){this._value!==e&&(this._value=e,this.notify(this._value))}}i.Observable=h}),define("modules/utils",["require","exports","./constants"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.capitalize=i.getValueFromTags=void 0;const h=(e,t,o=s.DELIMETER)=>{const l=e.find(n=>n.trim().startsWith(`${t}${o}`));return l?l.split(s.DELIMETER)[1].trim():""};i.getValueFromTags=h;const c=e=>e?e.split(" ").map(o=>o[0].toUpperCase()+o.slice(1)).join(" "):"";i.capitalize=c}),define("modules/questionStrategies/QuestionStrategy",["require","exports"],function(C,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.QuestionStrategy=void 0;class s{constructor(c,e){this.name=c,this.experience=e}}i.QuestionStrategy=s}),define("modules/questionStrategies/HidingOptionsStrategy",["require","exports","./QuestionStrategy"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.HidingOptionsStrategy=void 0;class h extends s.QuestionStrategy{constructor(e,t,o,l){super(e,t),this.currentNodeObservable=o,this.CerosSDK=l,this.isMobile=this.experience.findComponentsByTag("mobile").components.length>0,this.isTablet=this.experience.findComponentsByTag("tablet").components.length>0,this.evenOptions=this.experience.findLayersByTag(`${e.toLowerCase()}_even`),this.oddOptions=this.experience.findLayersByTag(`${e.toLowerCase()}_odd`)}displayAnswerOptions(e){const t=e.children.sort((o,l)=>Number(o.value)-Number(l.value));this.isMobile||this.isTablet?console.log("MOBILE LAYOUT!"):this.displayDesktopLayoutOptions(t)}displayDesktopLayoutOptions(e){e.length%2===0?(this.oddOptions.hide(),this.evenOptions.show(),this.handleTextOptions(this.evenOptions,e)):(this.oddOptions.show(),this.evenOptions.hide(),this.handleTextOptions(this.oddOptions,e))}handleTextOptions(e,t){const o=e.layers[0].findAllComponents(),l=o.layersByTag.answer.length,n=Math.floor((l-t.length)/2);let r=0;o.components.forEach(a=>{if(a.type==="text"){const g=r-n;r>=n&&g<t.length?(a.setText(t[g].value),t[g].elementId=a.id):a.hide(),r++}else a.type==="line"&&this.handleLineDivider(a,n,t)})}handleLineDivider(e,t,o){const l=isNaN(Number(e.getPayload()))?null:Number(e.getPayload());l?l>t&&l-t<o.length||e.hide():console.error(`there is no position number in payload of divider line with id ${e.id} in question ${o[0].name}`)}}i.HidingOptionsStrategy=h}),define("modules/questionStrategies/MaskingOptionsStrategy",["require","exports","./QuestionStrategy"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MaskingOptionsStrategy=void 0;class h extends s.QuestionStrategy{constructor(e,t,o,l){super(e,t),this.currentNodeObservable=o,this.CerosSDK=l,this.maskCollection=this.experience.findLayersByTag(`mask:${this.name}`)}displayAnswerOptions(e){this.maskCollection.layers.forEach(t=>{this.handleMasks(t,e)})}handleMasks(e,t){t.findChildByValueProperty(e.getPayload().trim())?e.hide():e.show()}registerMaskAnimations(){this.maskCollection.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,e=>{this.handleMasks(e,this.currentNodeObservable.value)})}}i.MaskingOptionsStrategy=h}),define("modules/DoubleClickBugHandler",["require","exports"],function(C,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DoubleClickBugHandler=void 0;class s{constructor(){this.clickObjectTimeTracker={}}isDoubleClickBug(c){const e=Date.now(),t=this.clickObjectTimeTracker[c];if(this.clickObjectTimeTracker[c]=e,t){const o=e-t;return console.log(o),o<900}}}i.DoubleClickBugHandler=s}),define("modules/LandinPageProxy",["require","exports","./DoubleClickBugHandler"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.LandingPageProxy=void 0;class h{constructor(){this.windowObjectReference=null,this.doubleClickBugHandler=new s.DoubleClickBugHandler,this.isPreview=window.self==window.top&&window.location.hostname.includes(".preview.ceros")}sendUAEvent(e){if(window.self!==window.top){const t={event_category:"CEROS",event_label:e,event_action:"outbound_link_click"};parent.postMessage(JSON.stringify(t),"*")}else window.dataLayer.push({event:"ceros-event",cerosAction:"ceros_outbound_link_click",cerosCategory:"CEROS",cerosLabel:e}),this.openRequestedSingleTab(e)}openRequestedSingleTab(e){this.windowObjectReference===null||this.windowObjectReference.closed?this.windowObjectReference=window.open(e,"_blank"):(this.windowObjectReference=window.open(e,"_blank"),this.windowObjectReference.focus())}openAndTrackLink(e,t){this.doubleClickBugHandler.isDoubleClickBug(t)||(this.isPreview?this.openRequestedSingleTab(e):this.sendUAEvent(e))}}i.LandingPageProxy=h}),define("modules/ModuleHandler",["require","exports","./constants"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ModuleHandler=void 0;class h{constructor(e,t,o,l,n,r){this.moduleName=e,this.experience=t,this.CerosSDK=o,this.distributor=l,this.landingPageProxy=n,this.imgLrgLink=r,this.moduleDict={},this.isNew=!1,this.imgLargeHotspotCollection=this.experience.findComponentsByTag(`${s.IMG_LRG}-1`)}hideModule(e,t){const o=this.getModuleTag(e,t),l=this.experience.findLayersByTag(o);if(!l.layers.length){console.error(`No module found with tag: ${o}`);return}l.hide()}updateModule(e,t,o,l){const n=this.getModuleTag(e,t),r=this.experience.findLayersByTag(n);if(!r.layers.length){console.error(`No module found with tag: ${n}`);return}const g=r.layers[0].findAllComponents().layersByTag,u=e.toString();this.moduleDict[u]=this.moduleDict[u]||{},this.isNew=!this.moduleDict[u][n],this.moduleDict[u][n]||(this.moduleDict[u][n]={data:{},layers:{}}),this.moduleDict[u][n].data=o,this.moduleDict[u][n].layers=g,this.processLayers(g,n),l&&l(g,n),console.log(this.moduleDict),r.show()}getModuleTag(e,t){return e>1?`${e}-${this.moduleName}-${t+1}`:`${e}-${this.moduleName}`}processLayers(e,t){e[s.IMAGE]&&this.showImageFromUrl(t,h.handleModuleImage,e[s.IMAGE]),e[s.PART]&&this.updateResultTextbox(s.PART,t,e[s.PART]),e[s.SERIES]&&this.updateResultTextbox(s.SERIES,t,e[s.SERIES]),e[s.DATASHEET]&&this.registerResultClcikEvent(e[s.DATASHEET],s.DATASHEET,t),e[s.PRINT]&&this.registerResultClcikEvent(e[s.PRINT],s.PRINT,t),e[s.BUY_NOW]&&this.registerResultClcikEvent(e[s.BUY_NOW],this.distributor,t),e[s.PRODUCT_GUIDE]&&this.registerResultClcikEvent(e[s.PRODUCT_GUIDE],s.PRODUCT_GUIDE,t),e[s.SPECS]&&this.updateResultTextbox(s.SPECS,t,e[s.SPECS]),e[s.DESCRIPTION]&&this.updateResultTextbox(s.DESCRIPTION,t,e[s.DESCRIPTION])}showImageFromUrl(e,t,o){o.forEach(l=>{const n=this.getResultData(e);t(l,n.data),this.isNew&&l.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,r=>{const a=this.getResultData(e);t(r,a.data)}),this.isNew&&l.on(this.CerosSDK.EVENTS.CLICKED,r=>{const a=this.getResultData(e);this.imgLrgLink.value=a.data.image,this.imgLargeHotspotCollection.click()})})}updateResultTextbox(e,t,o){o.forEach(l=>{const n=this.getResultData(t);l.setText(n.data[e]),this.isNew&&l.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,r=>{const a=this.getResultData(t);r.setText(a.data[e])})})}registerResultClcikEvent(e,t,o){e.forEach(l=>{l.on(this.CerosSDK.EVENTS.CLICKED,()=>{const n=this.getResultData(o);this.landingPageProxy.openAndTrackLink(n.data[t],l.id)}),l.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,n=>{this.getResultData(o).data[t]||n.hide()})})}static handleModuleImage(e,t){const o=t.image;try{new URL(o),e.setUrl(o)}catch(l){console.error(l),e.setUrl(s.DEFAULT_IMAGE)}}getResultData(e){const t=e.split("-")[0];return this.moduleDict[t][e]}}i.ModuleHandler=h}),define("modules/Carousel",["require","exports","./Observer","./DoubleClickBugHandler"],function(C,i,s,h){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Carousel=void 0;class c{constructor(t,o,l,n,r){this.max=t,this.name=o,this.CerosSDK=l,this.experience=n,this.moduleHandler=r,this.currentPage=new s.Observable(0),this.parts=[],this.next=this.experience.findLayersByTag(`${this.name}-next`),this.back=this.experience.findLayersByTag(`${this.name}-back`),this.currentIndex=this.experience.findComponentsByTag(`${this.name}-current`),this.totalIndex=this.experience.findComponentsByTag(`${this.name}-total`),this.pages={},this.doubleClickBugHandler=new h.DoubleClickBugHandler,this.registerNavigationEvents()}init(t){this.pages={},this.parts=t,this.paginate(),this.setTotalPageIndex(),this.currentPage.value=1}paginate(){let t=0,o=1;for(;t<this.parts.length;){const l=t+this.max<this.parts.length?t+this.max:this.parts.length;this.pages[o]=this.parts.slice(t,l),t=t+this.max,o++}console.log(this.pages)}registerNavigationEvents(){this.next.on(this.CerosSDK.EVENTS.CLICKED,t=>{this.doubleClickBugHandler.isDoubleClickBug(t.id)||(this.currentPage.value++,console.log(this.currentPage.value))}),this.back.on(this.CerosSDK.EVENTS.CLICKED,t=>{this.doubleClickBugHandler.isDoubleClickBug(t.id)||this.currentPage.value--}),this.next.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,()=>{this.isLastPage()&&this.next.hide()}),this.back.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,()=>{this.isFirstPage()&&this.back.hide()}),this.currentPage.subscribe(()=>{this.hideModules(),this.updatePageIndex(),this.populate(),this.isLastPage()?this.next.hide():this.next.show(),this.isFirstPage()?this.back.hide():this.back.show()})}populate(){let t=0;const o=this.pages[this.currentPage.value];for(;t<this.max&&t<o.length;){const l=o[t];l&&this.moduleHandler.updateModule(this.max,t,l),t++}}hideModules(){let t=0;for(;t<this.max;)this.moduleHandler.hideModule(this.max,t),t++}updatePageIndex(){this.currentIndex.components.forEach(t=>t.setText(this.currentPage.value.toString()))}setTotalPageIndex(){const t=Object.keys(this.pages);this.totalIndex.components.forEach(o=>o.setText(t[t.length-1]))}isLastPage(){const t=Object.keys(this.pages);return this.currentPage.value===Number(t[t.length-1])}isFirstPage(){return this.currentPage.value===1}}i.Carousel=c});var __awaiter=this&&this.__awaiter||function(C,i,s,h){function c(e){return e instanceof s?e:new s(function(t){t(e)})}return new(s||(s=Promise))(function(e,t){function o(r){try{n(h.next(r))}catch(a){t(a)}}function l(r){try{n(h.throw(r))}catch(a){t(a)}}function n(r){r.done?e(r.value):c(r.value).then(o,l)}n((h=h.apply(C,i||[])).next())})};define("modules/ResultHandler",["require","exports","./constants","./LandinPageProxy","./ModuleHandler","./DoubleClickBugHandler","./Carousel"],function(C,i,s,h,c,e,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ResultHandler=void 0;class o{constructor(n,r,a,g,u,d,f,E){this.experience=n,this.CerosSDK=r,this.currentNodeObservable=a,this.distributor=g,this.relatedProductsLink=u,this.accessoriesLink=d,this.PapaParse=f,this.imgLrgLink=E,this.csvData={"related products":{},accessories:{}},this.doubleClickBugHandler=new e.DoubleClickBugHandler,this.landingPageProxy=new h.LandingPageProxy,this.resultModulesHandler=new c.ModuleHandler(s.RESULTS,n,r,g,this.landingPageProxy,this.imgLrgLink),this.relatedProductsModulesHandler=new c.ModuleHandler(s.RELATED_PRODUCTS,n,r,g,this.landingPageProxy,this.imgLrgLink),this.accessoriesModulesHandler=new c.ModuleHandler(s.ACCESSORIES,n,r,g,this.landingPageProxy,this.imgLrgLink),this.accessoriesCarousel=new t.Carousel(s.MAX_ACCESSORIES,s.ACCESSORIES,r,n,this.accessoriesModulesHandler),this.relatedProductsCarousel=new t.Carousel(s.MAX_RELATED_PRODUCTS,s.RELATED_PRODUCTS,r,n,this.relatedProductsModulesHandler),this.resultsCarousel=new t.Carousel(s.MAX_RESULTS,s.RESULTS,r,n,this.resultModulesHandler)}showResultModule(n){this.updateResultModules(n),this.triggerHotspot(s.RESULTS,n,s.MAX_RESULTS)}sortNodesBySales(){return this.currentNodeObservable.value.children.sort((n,r)=>{const a=isNaN(Number(n.data.sales))?0:Number(n.data.sales);return(isNaN(Number(r.data.sales))?0:Number(r.data.sales))-a})}updateResultModules(n){const r=this.sortNodesBySales();r.length<=s.MAX_RESULTS?r.forEach((a,g)=>{this.resultModulesHandler.updateModule(n,g,a.data,this.processOverlayLayers.bind(this))}):this.resultsCarousel.init(r.map(a=>a.data))}processOverlayLayers(n,r){n[s.RELATED_PRODUCTS]&&this.handleOverlay(s.RELATED_PRODUCTS,n[s.RELATED_PRODUCTS],r,this.relatedProductsLink),n[s.ACCESSORIES]&&this.handleOverlay(s.ACCESSORIES,n[s.ACCESSORIES],r,this.accessoriesLink)}updateRelatedProductsModules(n){n.length<=s.MAX_RELATED_PRODUCTS?n.forEach((r,a)=>{this.relatedProductsModulesHandler.updateModule(n.length,a,r)}):this.relatedProductsCarousel.init(n)}updateAccessoriesModules(n){n.length<=s.MAX_ACCESSORIES?n.forEach((r,a)=>{this.accessoriesModulesHandler.updateModule(n.length,a,r)}):this.accessoriesCarousel.init(n)}handleOverlay(n,r,a,g){r.forEach(u=>{this.registerOverlayAnimation(u,a,n),this.registerOverlayClick(u,a,n,g)})}registerOverlayAnimation(n,r,a){n.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,g=>{if(this.getPartNumbers(r,a).length===0)g.hide();else if(a===s.ACCESSORIES){const d=!!this.getPartNumbers(r,s.RELATED_PRODUCTS).length,f=!!this.getValue(r,s.PRODUCT_GUIDE);d||f?g.getTags().find(E=>E==="pos:1")&&g.hide():g.getTags().find(E=>E==="pos:2")&&g.hide()}})}registerOverlayClick(n,r,a,g){n.on(this.CerosSDK.EVENTS.CLICKED,u=>__awaiter(this,void 0,void 0,function*(){if(this.doubleClickBugHandler.isDoubleClickBug(u.id))return;const d=this.getPartNumbers(r,a);if(!d.length)return;yield this.loadCsvData(a,g);const f=this.getExistingParts(a,d);f.length&&(a===s.RELATED_PRODUCTS?(this.updateRelatedProductsModules(f),this.triggerHotspot(a,f.length,s.MAX_RELATED_PRODUCTS)):a===s.ACCESSORIES&&(this.updateAccessoriesModules(f),this.triggerHotspot(a,f.length,s.MAX_ACCESSORIES)))}))}triggerHotspot(n,r,a){this.experience.findComponentsByTag(`${n}-${r<=a?r:`${a+1}+`}`).click()}getPartNumbers(n,r){const a=this.getValue(n,r);return a?a.split(s.DIVIDER).map(g=>g.replace(" ","")):[]}getValue(n,r){return this.resultModulesHandler.getResultData(n).data[r]}getExistingParts(n,r){const a=[];return r.forEach(g=>{this.csvData[n][g]?a.push(this.csvData[n][g]):console.error(`could not find part: ${g} from ${n}!`)}),a}loadCsvData(n,r){return new Promise((a,g)=>{this.csvData[n]&&Object.keys(this.csvData[n]).length>0?a(this.csvData[n]):this.PapaParse.parse(r,{header:!0,download:!0,complete:u=>{const d=this.indexByPartNumber(u.data);this.csvData[n]=d,a(this.csvData[n])},error:u=>g(u)})})}indexByPartNumber(n){const r={};return n.forEach(a=>{r[a.part.trim()]=a}),r}}i.ResultHandler=o}),define("modules/questionStrategies/MaskingOptionsWithSubCategoriesStrategy",["require","exports","./MaskingOptionsStrategy"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.MaskingOptionsWithSubcategoriesStrategy=void 0;class h extends s.MaskingOptionsStrategy{displayAnswerOptions(e){console.log(e.name),this.experience.findLayersByTag(`cat:${e.children[0].name}`).layers.forEach(o=>{o.getPayload().trim()===e.value?o.show():o.hide()}),this.maskCollection.layers.forEach(o=>{this.handleMasks(o,e)})}}i.MaskingOptionsWithSubcategoriesStrategy=h});var __awaiter=this&&this.__awaiter||function(C,i,s,h){function c(e){return e instanceof s?e:new s(function(t){t(e)})}return new(s||(s=Promise))(function(e,t){function o(r){try{n(h.next(r))}catch(a){t(a)}}function l(r){try{n(h.throw(r))}catch(a){t(a)}}function n(r){r.done?e(r.value):c(r.value).then(o,l)}n((h=h.apply(C,i||[])).next())})};define("modules/QuizContext",["require","exports","./constants","./Observer","./utils","./questionStrategies/HidingOptionsStrategy","./questionStrategies/MaskingOptionsStrategy","./ResultHandler","./DoubleClickBugHandler","./questionStrategies/MaskingOptionsWithSubCategoriesStrategy","./ModuleHandler"],function(C,i,s,h,c,e,t,o,l,n,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.QuizContext=void 0;class a{constructor(u,d,f,E,S,T,p){this.CerosSDK=u,this.experience=d,this.nodeTree=f,this.distributor=E,this.relatedProductsLink=S,this.accessoriesLink=T,this.PapaParse=p,this.questions={},this.imgLargeOverlayCollection=this.experience.findLayersByTag(s.IMG_LRG),this.imgLrgLink=new h.Observable(""),this.imgLrgCloseHotspotCollection=this.experience.findLayersByTag(`${s.IMG_LRG}-close`),this.currentNode=new h.Observable(this.nodeTree.root),this.answerCollection=this.experience.findComponentsByTag(s.OPTION),this.backLayersCollection=this.experience.findLayersByTag(s.BACK),this.navCollecttion=this.experience.findComponentsByTag(s.NAV),this.pathTextCollection=this.experience.findComponentsByTag(s.PATH),this.resetCollection=this.experience.findLayersByTag(s.RESET),this.mcaseAdapterCtaCollection=this.experience.findLayersByTag(`${s.MCASE_ADAPTER}-cta`),this.resultHandler=new o.ResultHandler(d,u,this.currentNode,E,S,T,p,this.imgLrgLink),this.mcaseAdapterModuleHandler=new r.ModuleHandler(s.MCASE_ADAPTER,d,u,E,this.resultHandler.landingPageProxy,this.imgLrgLink),this.doubleClickHandler=new l.DoubleClickBugHandler,this.init()}init(){this.subscribeCurrentNodeObserver(),this.subscribeToCerosEvents(),this.assignQuestionsStrategy(),this.registerImageOverlay()}registerImageOverlay(){this.imgLargeOverlayCollection.on(this.CerosSDK.EVENTS.ANIMATION_STARTED,u=>{r.ModuleHandler.handleModuleImage(u,{image:this.imgLrgLink.value})}),this.imgLrgCloseHotspotCollection.on(this.CerosSDK.EVENTS.CLICKED,()=>{this.imgLrgLink.value=""}),this.imgLrgLink.subscribe(u=>{this.imgLargeOverlayCollection.layers.forEach(d=>{r.ModuleHandler.handleModuleImage(d,{image:u})})})}subscribeCurrentNodeObserver(){this.currentNode.subscribe(this.handleNodeChange.bind(this)),this.currentNode.subscribe(this.updatePath.bind(this))}assignQuestionsStrategy(){for(const u in s.fieldNodesDict){const d=s.fieldNodesDict[u];let f;d.type==="question"&&(d.questionStrategy==="hiding"?f=new e.HidingOptionsStrategy(u,this.experience,this.currentNode,this.CerosSDK):d.questionStrategy==="masking-with-subcategories"?f=new n.MaskingOptionsWithSubcategoriesStrategy(u,this.experience,this.currentNode,this.CerosSDK):f=new t.MaskingOptionsStrategy(u,this.experience,this.currentNode,this.CerosSDK),this.questions[u]=f)}}subscribeToCerosEvents(){this.answerCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleAnswerClick.bind(this)),this.backLayersCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleBackNavigation.bind(this)),this.navCollecttion.on(this.CerosSDK.EVENTS.CLICKED,this.handleRandomNavigation.bind(this)),this.resetCollection.on(this.CerosSDK.EVENTS.CLICKED,this.resetQuiz.bind(this)),this.mcaseAdapterCtaCollection.on(this.CerosSDK.EVENTS.CLICKED,this.handleMcaseAdapter.bind(this))}handleMcaseAdapter(u){return __awaiter(this,void 0,void 0,function*(){if(this.doubleClickHandler.isDoubleClickBug(u.id))return;const d=u.getPayload().trim();yield this.resultHandler.loadCsvData(s.RELATED_PRODUCTS,this.relatedProductsLink);const f=this.resultHandler.csvData[s.RELATED_PRODUCTS][d];f?(this.mcaseAdapterModuleHandler.updateModule(1,0,f),this.experience.findComponentsByTag(`${s.MCASE_ADAPTER}-1`).click()):console.error(`Could not find part ${d} in related products sheet`)})}resetQuiz(){this.currentNode.value=this.nodeTree.root}handleAnswerClick(u){if(this.doubleClickHandler.isDoubleClickBug(u.id))return;const d=(0,c.getValueFromTags)(u.getTags(),s.QUESTION),f=this.questions[d],E=u.getPayload().trim();if(!f){console.error(`Could not find question field ${d}`);return}const{key:S,value:T}=f instanceof e.HidingOptionsStrategy?{key:"elementId",value:u.id}:{key:"value",value:E},p=this.nodeTree.findChild(this.currentNode.value,S,T);if(p)if(s.fieldNodesDict[d].skipif&&s.fieldNodesDict[d].skipif.find(b=>b===E)){const b=p.children[0];this.currentNode.value=b}else this.currentNode.value=p;else console.error(`coudn't find node with ${d} and value ${T}`)}handleBackNavigation(u){if(this.doubleClickHandler.isDoubleClickBug(u.id))return;const d=this.currentNode.value,f=d.parent;if(!f)return;const E=d.name;console.log(`clicked back to ${d.name}`);const S=s.fieldNodesDict[E];if(S&&S.skipBackIf){const T=S.skipBackIf,p=Object.keys(T)[0],b=T[p],m=d.findParentByName(p);if(m&&b.find(y=>y===m.value)){this.currentNode.value=f.parent||f;return}}this.currentNode.value=f}handleRandomNavigation(u){const d=u.getPayload().toLowerCase(),f=this.currentNode.value.findParentByName(d);f&&f.parent?this.currentNode.value=f.parent:console.error(`Could not find node ${d} or it's parent`)}handleNodeChange(u){if(u.children)if(this.isLastQuestion(u))this.resultHandler.showResultModule(u.children.length);else{console.log(this.currentNode.value);const d=u.children[0].name.toLowerCase();this.questions[d]&&this.questions[d].displayAnswerOptions(u)}}updatePath(u){let d=u;const f=[];d.getPath().forEach(({name:S,value:T})=>{if(S==="Root")return;const b=s.fieldNodesDict[S].pathText.replace("{{}}",(0,c.capitalize)(T));f.push(b)}),f.length?this.pathTextCollection.setText(f.join("  >  ")):this.pathTextCollection.setText(""),this.pathTextCollection.show()}isLastQuestion(u){const d=u.children[0];return Object.keys(d.data).length}}i.QuizContext=a}),define("modules/Node",["require","exports"],function(C,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Node=void 0;class s{constructor(c,e="",t=null){this.name=c,this.value=e,this.parent=t,this.children=[],this.elementId="",this.data={}}findChildByValueProperty(c){return this.children.find(e=>e.value.toLowerCase()===c.toLowerCase())||null}findParentByName(c){let e=this;for(;e;){if(e.name===c)return e;e=e.parent}}getPath(){const c=[];let e=this;for(;e;)c.unshift({name:e.name,value:e.value}),e=e.parent;return c}}i.Node=s}),define("modules/NodeTree",["require","exports","./Node"],function(C,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.NodeTree=void 0;class h{constructor(e){this.fields=e,this.root=new s.Node("Root")}buildTree(e){e.forEach(t=>{this.addBranch(this.root,t)}),console.log(this.root)}addNewNode(e,t,o,l={}){const n=o.findChildByValueProperty(e);if(n)return n;{const r=new s.Node(t,e,o);return r.data=l,o.children.push(r),r}}addBranch(e,t){let o=e;const l=Object.keys(this.fields);for(let n=0;n<l.length;n++){const r=l[n].trim(),a=t[r].trim();this.fields[l[n]].type==="result"?o=this.addNewNode(a,r,o,t):o=this.addNewNode(a,r,o)}}findChild(e,t,o){return e.children.find(l=>l[t].toLowerCase()===o.toLowerCase().trim())}}i.NodeTree=h});const script=document.getElementById("fuse-holders");if(script===null)throw Error("Could not find script fuse-holders");const link=script.getAttribute("data-link")||"",distributor=script.getAttribute("data-distributor")||"",relatedProductsLink=script.getAttribute("data-related-products")||"",accessoriesLink=script.getAttribute("data-accessories")||"";typeof require<"u"&&typeof require=="function"&&(require.config({baseUrl:"http://127.0.0.1:5173/",paths:{CerosSDK:"//sdk.ceros.com/standalone-player-sdk-v5.min",PapaParse:"https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min"}}),require(["CerosSDK","PapaParse","modules/QuizContext","modules/NodeTree","modules/constants"],function(C,i,s,h,c){C.findExperience().done(e=>{const t=new h.NodeTree(c.fieldNodesDict);i.parse(link,{download:!0,header:!0,complete:o=>{t.buildTree(o.data),new s.QuizContext(C,e,t,distributor,relatedProductsLink,accessoriesLink,i)}})}).fail(e=>{console.log(e)})})),define("main",function(){});
